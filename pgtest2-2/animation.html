<html>
<head>
<title>pgtest2-2</title>
<script language="javascript">
// 画像の表示座標・移動量
var x  = 455; // 表示する座標
var y  = 250; // 表示する座標
var pv = 10; // 1回の移動量

// キーボードのフラグ（1:押されている, 0:離されている）
var left  = 0 ;
var right = 0 ;
var cnt=1;

var img = new Array();
img[1] = new Image();
img[1].src = "images/mario_1.png";
img[2] = new Image();
img[2].src = "images/mario_2.png";
img[3] = new Image();
img[3].src = "images/mario_3.png";
img[4] = new Image();
img[4].src = "images/mario_4.png";
img[5] = new Image();
img[5].src = "images/mario_5.png";
img[6] = new Image();
img[6].src = "images/mario_6.png";

document.onkeydown = keydown;
document.onkeyup   = keyup;

// キーが押されている時
function keydown(event)
{
    try {
        //left key
        if(event.keyCode == 37) {
            left = 1;
            //左向き画像
            if (cnt == 3 || cnt == 6) {
                { cnt = 4; }
            } else if (cnt == 1 || cnt == 4) {
                { cnt = 5; }
            } else if (cnt == 2 || cnt == 5) {
                { cnt = 6; }
            }
        //画像を切り替える
        document.getElementById("marioImage").src=img[cnt].src;
        }
        //right key
        if(event.keyCode == 39) {
            right = 1;
            //右向き画像
            if (cnt == 3 || cnt == 6) {
                { cnt = 1; }
            } else if (cnt == 1  || cnt == 4) {
                { cnt = 2; }
            } else if (cnt == 2 || cnt == 5) {
                {cnt = 3;}
            }
        //画像を切り替える
        document.getElementById("marioImage").src=img[cnt].src;
        }
    disp();
    } catch (e){
        alert(e);
    }    
}

// 表示座標更新
function disp()
{
    try {
        if(left == 1 && x > -5) {
            x = x - pv;
        }
        if(right == 1 && x < 1000) {
            x = x + pv;
        }
        document.getElementById("mario").style.left = x;
    } catch (e){
        alert(e);
    }  
}

// キーが押されていない時
function keyup(event)
{
    try {
        //left key
        if(event.keyCode == 37) {
            left = 0;
        }
        //right key
        if(event.keyCode == 39) {
            right = 0;
        }
    } catch (e){
        alert(e);
    }  
}
</script>
<style type="text/css">
div.sky {
    background-color: #3399FF;
    width:1080px;
    height:480px;
    position:absolute;
    TOP:0px;
    LEFT:0px;
}

div.ground {
    background-color:#800000;
    width:1080px;
    height:200px;
    position:absolute;
    TOP:480px;
    LEFT: 0px;
}    
</style>
</head>
<body>
    <div class="sky"></div>
    <div class="ground"></div>
    <div id="mario" style="POSITION:absolute;Z-INDEX:1;VISIBILITY:visible;TOP:400px;LEFT:450px;">
        <img id="marioImage" src="images/mario_1.png">
    </div>
</body>
</html>
